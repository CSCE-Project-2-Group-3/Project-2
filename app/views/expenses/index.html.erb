<h1>Expense Tracker</h1>

<% if notice %>
  <p style="color: green;"><%= notice %></p>
<% end %>
<% if alert %>
  <p style="color: red;"><%= alert %></p>
<% end %>


<%= form_with url: bulk_upload_expenses_path, multipart: true, local: true do %>
  <%= file_field_tag :file, accept: ".csv,.xlsx" %>
  <%= submit_tag "Bulk Import" %>
  <%= link_to "Download Template", download_template_expenses_path %>
<% end %>

<p><%= link_to "Add New Expense", new_expense_path %></p>


<table border="1" cellspacing="0" cellpadding="5">
  <thead><tr><th>Date</th><th>Title</th><th>Category</th><th>Amount</th><th>Notes</th><th>Actions</th></tr></thead>
  <tbody>
    <% @expenses.each do |e| %>
      <tr>
        <td><%= e.spent_on %></td>
        <td><%= e.title %></td>
        <td><%= e.category.name %></td>
        <td><%= e.amount %></td>
        <td><%= e.notes %></td>
        <td>
          <%= link_to "Edit", edit_expense_path(e) %> |
          <%= link_to "Delete", expense_path(e), data: { turbo_confirm: "Delete this?" }, method: :delete %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<p><strong>Total:</strong> <%= @total %></p>
<%= paginate @expenses %>
<div style="margin-top:12px;">
  <%= button_to "Logout", destroy_user_session_path,
        method: :delete,
        form: { data: { turbo: false }, style: "display:inline" } %>
</div>
