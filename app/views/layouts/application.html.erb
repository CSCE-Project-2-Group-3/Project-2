<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Expense Tracker" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= favicon_link_tag 'logo.png' %>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --tamu-maroon: #500000;
        --tamu-white: #FFFFFF;
        --tamu-gray-100: #f7fafc;
        --tamu-gray-200: #edf2f7;
        --tamu-gray-500: #a0aec0;
        --tamu-gray-700: #4a5568;
        --tamu-gray-800: #2d3748;
        --tamu-gray-light: #f7fafc;
        --tamu-gray-medium: #e2e8f0;
        --tamu-gray-dark: #4a5568;
        --tamu-accent: #8A6319; 
      }
      body {
        font-family: 'Inter', sans-serif;
        background-color: var(--tamu-gray-100);
        color: var(--tamu-gray-800);
      }
      .btn-maroon {
        background-color: var(--tamu-maroon);
        color: var(--tamu-white);
      }
      .btn-icon-maroon:hover {
        background-color: var(--tamu-maroon);
        color: var(--tamu-white);
      }
      .btn-maroon:hover { background-color: #400000; }
      .form-input:focus {
        border-color: var(--tamu-maroon);
        box-shadow: 0 0 0 2px rgba(80, 0, 0, 0.2);
        outline: none;
      }
    </style>
    <%= javascript_importmap_tags %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  </head>

  <body class="antialiased bg-tamu-gray-100 text-tamu-gray-800 font-sans">
    <%# ✅ Flash messages styled using Tailwind %>
    <% if notice %>
      <div class="flash-notice bg-green-500 text-white font-semibold px-6 py-3 rounded shadow-lg text-center">
        <%= notice %>
      </div>
    <% end %>
    <% if alert %>
      <div class="flash-alert bg-red-500 text-white font-semibold px-6 py-3 rounded shadow-lg text-center">
        <%= alert %>
      </div>
    <% end %>

    <%# ✅ Header styled with same TAMU theme %>
  <header class="bg-white shadow-sm border-b border-gray-200">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
      <div>
      <a href="/" class="flex items-center space-x-3">
        <%= image_tag "logo.png", alt: "ExpenseTracker Logo", class: "h-8 w-8" %>
        <span class="text-2xl font-bold" style="color: var(--tamu-maroon);">Expense Tracker</span>
      </a>
    </div>

      <div class="flex items-center space-x-2">
        <% if user_signed_in? %>

          <%# --- NEW ICONS START HERE (Updated Dashboard & Groups) --- %>

          <%# Dashboard (Chart/Graph Icon) %>
          <%= link_to dashboard_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "Dashboard" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
            </svg>
          <% end %>

          <%# All Expenses (Document/List Icon) %>
          <%= link_to expenses_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "All Expenses" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
          <% end %>

          <%# My Groups (Folder/Document-Multiple Icon) %>
          <%= link_to groups_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "My Groups" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
            </svg>
          <% end %>

          <%# Messages (Chat Icon) %>
          <%= link_to conversations_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "Messages" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
            </svg>
          <% end %>

          <%# Backup & Restore %>
          <%= link_to new_backup_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "Backup & Restore" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
            </svg>
          <% end %>

          <%# My Account (User Circle Icon) %>
          <%= link_to edit_user_registration_path, class: "p-2 rounded-full text-gray-500 hover:bg-gray-200 hover:text-tamu-maroon transition-colors", title: "My Account" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          <% end %>

          <%# Logout (Logout Icon) %>
          <%= button_to destroy_user_session_path, method: :delete, class: 'ml-2 p-2 rounded-full text-gray-500 hover:bg-red-100 hover:text-red-600 transition-colors', title: "Logout", form: { data: { turbo: false } } do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
          <% end %>
          
          <%# --- END NEW ICONS --- %>

        <% else %>
          <%= link_to 'Login', new_user_session_path, class: 'font-medium hover:underline mr-4', style: "color: var(--tamu-maroon);" %>
          <%= link_to 'Sign Up', new_user_registration_path, class: 'btn-maroon font-semibold py-2 px-4 rounded-lg' %>
        <% end %>
      </div>
    </nav>
  </header>

    <%# ✅ Main Content %>
    <main class="container mx-auto px-6 py-8">
      <%= yield %>
    </main>
  </body>
</html>